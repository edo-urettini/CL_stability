Failure # 1 (occurred at 2024-09-13_05-04-20)
[36mray::ImplicitFunc.train()[39m (pid=123646, ip=131.114.142.6, actor_id=b8eaef79ac06c81e78ee5aae01000000, repr=train_function)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/ray/tune/trainable/trainable.py", line 342, in train
    raise skipped from exception_cause(skipped)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/ray/air/_internal/util.py", line 91, in run
    self._ret = self._target(*self._args, **self._kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 249, in <lambda>
    training_func=lambda: self._trainable_func(self.config),
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 332, in _trainable_func
    output = fn()
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/ray/tune/trainable/util.py", line 321, in inner
    return trainable(config, **fn_kwargs)
  File "/data/e.urettini/projects/CL_stability/ocl_survey/experiments/main_hp_tuning.py", line 141, in train_function
    strategy.train(
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 168, in train
    super().train(experiences, eval_streams, **kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/templates/base.py", line 144, in train
    self._train_exp(self.experience, eval_streams, **kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 294, in _train_exp
    self.training_epoch(**kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/templates/update_type/sgd_update.py", line 34, in training_epoch
    self._before_update(**kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/templates/base_sgd.py", line 488, in _before_update
    trigger_plugins(self, "before_update", **kwargs)
  File "/data/e.urettini/anaconda3/envs/CL_stability/lib/python3.10/site-packages/avalanche/training/utils.py", line 69, in trigger_plugins
    getattr(p, event)(strategy, **kwargs)
  File "/data/e.urettini/projects/CL_stability/ocl_survey/src/strategies/ng.py", line 194, in before_update
    self.F_ema_inv = self.F_ema.inverse(regul = self.tau)
  File "/data/e.urettini/projects/CL_stability/nngeometry/object/pspace.py", line 438, in inverse
    inv_a = torch.inverse(
torch._C._LinAlgError: linalg.inv: The diagonal element 2 is zero, the inversion could not be completed because the input matrix is singular.
